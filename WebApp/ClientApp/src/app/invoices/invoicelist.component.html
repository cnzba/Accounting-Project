<nz-layout class="layout">
    <nz-sider nzCollapsible
              [(nzCollapsed)]="isCollapsed"
              [nzBreakpoint]="'lg'"
              [nzCollapsedWidth]="0"
              [nzZeroTrigger]="zeroTrigger">
        <div class="logo">
            <img src="../../assets/images/CBA-Logoupdated-01-1.jpeg" class="img-fluid" />
        </div>
        <ul nz-menu nzTheme="dark" nzMode="inline" [nzInlineCollapsed]="isCollapsed">
            <li nz-menu-item>
                <i nz-icon nzType="user"></i>
                <span>Authorization</span>
            </li>
            <li nz-menu-item>
                <i nz-icon nzType="video-camera"></i>
                <span>Invoice</span>
            </li>
            <li nz-menu-item>
                <i nz-icon nzType="upload"></i>
                <span>Payment</span>
            </li>
            <li nz-menu-item>
                <i nz-icon nzType="user"></i>
                <span>Customer</span>
            </li>
        </ul>
    </nz-sider>
    <nz-layout>        
        <nz-content>
            <div class="inner-content">
                <form class="form1">
                    <a id="createNew" class="btn btn-lg btn-success" [routerLink]="['/invoice/new']">
                        Create New Invoice
                    </a>


                    <div class="row">
                        <div class="col-md-6">
                            <input type="text"
                                   class="form-control"
                                   name="searchString"
                                   placeholder="Search..."
                                   [(ngModel)]="searchString" />
                        </div>
                        <div class="col-md-6">
                            <app-pagination class="pull-right" [offset]="offset" [limit]="limit" [size]="(sortedData | invoiceFilter : searchString).length" (pageChange)="onPageChange($event)"></app-pagination>
                        </div>
                    </div>


                    <table class="table table-bordered table-striped table-hover table-light"
                           matSort (matSortChange)="sortData($event)" matSortActive="dateCreated" matSortDirection="desc" matSortStart="desc" matSortDisableClear>
                        <thead class="thead-dark">
                            <tr>
                                <th mat-sort-header="invoiceNumber" style="width:10%">Invoice Number</th>

                                <th mat-sort-header="dateCreated" style="width: 10%">Date Created</th>
                                <th mat-sort-header="clientName" style="width: 10%">Client Name</th>
                                <th mat-sort-header="grandTotal" style="width: 10%">Amount</th>
                                <th mat-sort-header="dateDue" style="width: 10%">Due Date</th>
                                <th mat-sort-header="status" style="width: 10%">Status</th>

                            </tr>

                        </thead>

                        <tbody>
                            <tr *ngFor="let inv of sortedData | invoiceFilter : searchString; index as i ">
                                <ng-container *ngIf="i>=offset && i< offset +limit">
                                    <td *ngIf="inv.status==='Issued'||inv.status==='Paid'">
                                        <a [routerLink]="['/invoices', inv.invoiceNumber]">{{inv.invoiceNumber}}</a>
                                        <button class="btn btn-sm"
                                                id="pdf_ico"
                                                (click)="getPdfInvoice(inv.invoiceNumber)">
                                            <i class="fa fa-file-pdf-o"></i>
                                        </button>
                                    </td>

                                    <td *ngIf="inv.status==='New'||inv.status==='Draft'">
                                        <a [routerLink]="['/invoices/edit/',inv.invoiceNumber]">{{inv.invoiceNumber}} </a>
                                        <button class="btn btn-sm" id="delete_key" data-toggle="modal" data-target="#deleteModal" (click)="setinvoiceNum(inv.invoiceNumber)"> <span class="oi oi-trash"></span></button>
                                    </td>


                                    <td style="width: 10%">{{inv.dateCreated | date: 'dd/MM/yyyy'}}</td>
                                    <td style="width: 10%">{{inv.clientName}} </td>
                                    <td style="width: 10%">${{inv.grandTotal|number:'.2-2'}}</td>
                                    <td style="width: 10%">{{inv.dateDue | date: 'dd/MM/yyyy'}}</td>
                                    <td style="width: 10%">{{inv.status}}</td>

                                    <!--<td *ngIf="inv.status==='Draft'" style="width:0.1%" >
                        <button class="btn btn-sm" id="delete_key" data-toggle="modal" data-target="#deleteModal"><span class="oi oi-trash"></span></button>
                    </td>-->
                                </ng-container>

                            </tr>
                        </tbody>
                    </table>

                    <div class="row">
                        <div class="col-md-12">
                            <app-pagination class="pull-right" [offset]="offset" [limit]="limit" [size]="(sortedData | invoiceFilter : searchString).length" (pageChange)="onPageChange($event)"></app-pagination>
                        </div>
                    </div>

                    <div id="deleteModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">

                            <!-- Modal content-->
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h4 class="modal-title" id="deleteModalLabel">Are you sure?</h4>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                </div>
                                <div class="modal-body">
                                    <p>When you delete a draft invoice it cannot be undone!</p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                    <button type="submit" class="btn btn-primary" data-dismiss="modal" (click)="deleteFieldValue(getinvoiceNum())">Yes, Confirm!</button>
                                </div>
                            </div>

                        </div>
                    </div>
                    <a id="createNew" class="btn btn-lg btn-success" [routerLink]="['/invoice/new']">
                        Create New Invoice
                    </a>



                </form>
            </div>
        </nz-content>
    </nz-layout>
</nz-layout>
<ng-template #zeroTrigger>
    <i nz-icon nzType="menu-fold" nzTheme="outline"></i>
</ng-template>








